$path     = Split-Path -parent $MyInvocation.MyCommand.Definition  ;$newpath  = ".\input.txt" ;$ADGroups = Import-Csv $newpath  -Delimiter "," -Encoding UTF8;foreach ($Group in $ADGroups ){$groupName = $Group.groupName; $groupName | Get-ADGroup -OutVariable adgrp | Get-ADGroupMember | Get-ADUser -Properties samaccountname,DisplayName,EmailAddress,GivenName, Surname,name | select samaccountname, DisplayName, EmailAddress,  @{n='FirstName';e={$_.GivenName}}, @{n='LastName';e={$_.Surname}},@{n='FullName'; e={$_.name}},@{n='GroupName';e={$adgrp.Name}}, @{n='GroupSamAccountName';e={$adgrp.SamAccountName}},@{n='GroupDistinguishedName';e={$adgrp.distinguishedName}}|   export-csv -path ".\output.txt" -NoTypeInformation  -encoding UTF8 -append; }